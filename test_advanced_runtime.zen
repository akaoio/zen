# Advanced Runtime Features Test
# This test showcases the enhanced runtime capabilities

print "=== Advanced ZEN Runtime Test ==="

# Test 1: Basic arithmetic with constant folding optimization
set x 2 + 3 * 4
print "Constant expression result:", x

# Test 2: Define a function that will become "hot" with profiling
function fibonacci n
    if n <= 1
        return n
    else
        return fibonacci (n - 1) + fibonacci (n - 2)

# Test 3: Call function multiple times to trigger hot function optimization
print "Computing fibonacci numbers..."
set i 0
while i < 10
    set result fibonacci i
    print "fib(" + i + ") = " + result
    set i i + 1

# Test 4: Test exception handling with stack overflow protection
# (Commenting out to prevent actual stack overflow in testing)
# function infinite_recursion
#     return infinite_recursion

print "=== Runtime Features Tested ==="
print "- Performance profiling"
print "- Hot function detection"
print "- Constant folding optimization"
print "- Call stack management"
print "- Exception handling framework"